<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>CatÃ¡logo</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<script src="https://cdn.tailwindcss.com"></script>
</head>

<body class="bg-[#FDFBF7] text-[#2D2926]">

<!-- HEADER -->
<header class="bg-white border-b px-6 py-4 flex justify-between items-center">
  <h1 id="storeName" class="text-sm tracking-[0.4em] uppercase">
    CatÃ¡logo
  </h1>

  <a href="cart.html" class="relative text-sm">
    ðŸ›’ Carrinho
    <span id="cartCount"
      class="absolute -top-2 -right-3 bg-black text-white text-xs px-2 rounded-full">
      0
    </span>
  </a>
</header>

<!-- PRODUTOS -->
<main class="max-w-6xl mx-auto p-6">
  <div id="productGrid"
    class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-8">
  </div>
</main>

<script>
/* ===============================
   DADOS
================================ */
const store = JSON.parse(localStorage.getItem('luxury_config')) || {};
const products = JSON.parse(localStorage.getItem('luxury_products')) || [];
let cart = JSON.parse(localStorage.getItem('luxury_cart')) || [];

/* ===============================
   HELPERS
================================ */
const format = v =>
  v.toLocaleString('pt-BR', { style: 'currency', currency: 'BRL' });

function updateCartCount() {
  const count = cart.reduce((s, i) => s + i.qty, 0);
  document.getElementById('cartCount').innerText = count;
}

/* ===============================
   ADD TO CART
================================ */
function addToCart(id) {
  const product = products.find(p => p.id === id);
  if (!product) return;

  const item = cart.find(i => i.id === id);
  if (item) {
    item.qty++;
  } else {
    cart.push({ ...product, qty: 1 });
  }

  localStorage.setItem('luxury_cart', JSON.stringify(cart));
  updateCartCount();
}

/* ===============================
   RENDER
================================ */
document.getElementById('storeName').innerText =
  store.name || 'CatÃ¡logo';

const grid = document.getElementById('productGrid');

if (products.length === 0) {
  grid.innerHTML = `
    <p class="text-center col-span-full text-gray-500">
      Nenhum produto cadastrado no painel administrativo.
    </p>
  `;
}

products.forEach(p => {
  const pixDiscount = store.pixDiscount || 0;
  const maxInstallments = store.maxInstallments || 1;

  const pixPrice = p.price - (p.price * pixDiscount / 100);
  const installmentValue = p.price / maxInstallments;

  grid.innerHTML += `
    <div class="bg-white border p-6 text-center space-y-4">
      <img src="${p.image}"
        class="h-48 mx-auto object-contain" />

      <p class="uppercase text-sm tracking-wide">
        ${p.name}
      </p>

      <p class="line-through text-gray-400 text-sm">
        ${format(p.price)}
      </p>

      <p class="text-green-700 font-semibold">
        PIX ${format(pixPrice)}
      </p>

      <p class="text-xs text-gray-500">
        ${maxInstallments}x de ${format(installmentValue)}
      </p>

      <button
        onclick="addToCart(${p.id})"
        class="w-full bg-black text-white py-3 text-xs uppercase">
        Adicionar ao carrinho
      </button>
    </div>
  `;
});

updateCartCount();
</script>

</body>
</html>
