<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>Catálogo</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<script src="https://cdn.tailwindcss.com"></script>
</head>

<body class="bg-[#FDFBF7] text-[#2D2926]">

<header class="text-center py-8">
  <h1 id="storeName" class="text-2xl font-serif tracking-wide"></h1>
</header>

<main class="max-w-6xl mx-auto px-6 grid md:grid-cols-3 gap-8" id="productGrid"></main>

<script>
/* ===== LOAD CONFIG ===== */
const store = JSON.parse(localStorage.getItem('luxury_config')) || {};
document.getElementById('storeName').innerText = store.name || 'Catálogo';

/* ===== LOAD PRODUCTS ===== */
const products = JSON.parse(localStorage.getItem('luxury_products')) || [];
const grid = document.getElementById('productGrid');

const format = v => v.toLocaleString('pt-BR',{style:'currency',currency:'BRL'});

products.forEach(p => {
  const pixPrice = store.pixDiscount
    ? p.price - (p.price * store.pixDiscount)
    : p.price;

  const installment = store.maxInstallments
    ? (p.price / store.maxInstallments)
    : p.price;

  grid.innerHTML += `
    <div class="bg-white border p-6 text-center space-y-4">
      <img src="${p.image}" class="h-48 mx-auto object-contain">
      <p class="uppercase text-sm tracking-widest">${p.name}</p>

      <div class="space-y-1 text-sm">
        <p class="line-through text-gray-400">${format(p.price)}</p>
        <p class="font-semibold text-green-700">PIX: ${format(pixPrice)}</p>
        <p class="text-xs text-gray-500">
          ou ${store.maxInstallments}x de ${format(installment)}
        </p>
      </div>

      <button onclick="addToCart(${p.id})"
        class="w-full bg-black text-white py-3 text-xs uppercase">
        Adicionar ao Carrinho
      </button>
    </div>
  `;
});

/* ===== CART ===== */
function addToCart(id){
  let cart = JSON.parse(localStorage.getItem('luxury_cart')) || [];
  const prod = products.find(p => p.id === id);

  const exists = cart.find(i => i.id === id);
  if(exists){
    exists.qty++;
  } else {
    cart.push({...prod, qty:1});
  }

  localStorage.setItem('luxury_cart', JSON.stringify(cart));
  window.location.href = 'cart.html';
}
</script>

</body>
</html>
