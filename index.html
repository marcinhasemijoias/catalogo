<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Marcinha Semijoias | Catálogo</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-database-compat.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600&display=swap');
        body { font-family: 'Inter', sans-serif; background-color: #FDFBF7; }
    </style>
</head>
<body>
    <header class="py-12 text-center border-b border-[#E5E1DB] bg-white">
        <h1 class="font-serif text-4xl tracking-widest uppercase">Marcinha Semijoias</h1>
        <p class="text-[10px] tracking-[0.3em] uppercase text-[#8C857B] mt-2">Luxo e Sofisticação</p>
    </header>

    <main class="max-w-7xl mx-auto p-6 py-12 space-y-16">
        <div id="catalogContainer">
            <p class="text-center py-20 text-gray-400 uppercase tracking-widest text-xs">Carregando coleções...</p>
        </div>
    </main>

    <script>
        const firebaseConfig = {
            apiKey: "AIzaSyD5RdWTYOnaTov7VtM9ZGenUpFYSZVGoPs",
            authDomain: "marcinha-semijoias.firebaseapp.com",
            databaseURL: "https://marcinha-semijoias-default-rtdb.firebaseio.com",
            projectId: "marcinha-semijoias",
            storageBucket: "marcinha-semijoias.firebasestorage.app",
            messagingSenderId: "830107812924",
            appId: "1:830107812924:web:1ee54d9b875514e48eef39"
        };
        firebase.initializeApp(firebaseConfig);
        const db = firebase.database();

        const categoriasOrder = ["Brincos", "Colares", "Pulseiras", "Aneis"];

        function renderProducts() {
            db.ref('products').on('value', (snapshot) => {
                const data = snapshot.val();
                const products = data ? Object.keys(data).map(key => ({ id: key, ...data[key] })) : [];
                const container = document.getElementById("catalogContainer");
                container.innerHTML = "";

                categoriasOrder.forEach(cat => {
                    const produtosDaCat = products.filter(p => p.category === cat);
                    
                    if (produtosDaCat.length > 0) {
                        const section = document.createElement("section");
                        section.className = "mb-16";
                        section.innerHTML = `
                            <h2 class="font-serif text-2xl uppercase tracking-widest mb-8 border-b pb-2 text-[#A68966]">${cat}</h2>
                            <div class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-8">
                                ${produtosDaCat.map(p => `
                                    <div class="group">
                                        <div class="relative overflow-hidden bg-gray-100 aspect-[3/4]">
                                            <img src="${p.image}" class="w-full h-full object-cover transition duration-700 group-hover:scale-110">
                                            ${p.stock <= 0 ? '<div class="absolute inset-0 bg-white/60 flex items-center justify-center text-[10px] uppercase tracking-widest">Esgotado</div>' : ''}
                                        </div>
                                        <div class="mt-4 text-center">
                                            <h3 class="text-[11px] uppercase tracking-wider text-gray-500">${p.name}</h3>
                                            <p class="text-sm font-semibold mt-1">R$ ${Number(p.price).toFixed(2)}</p>
                                            <button onclick="addToCart('${p.id}', '${p.name}', ${p.price}, '${p.image}')" 
                                                class="mt-4 text-[10px] uppercase tracking-widest border-b border-black pb-1 hover:text-[#A68966] transition"
                                                ${p.stock <= 0 ? 'disabled style="opacity:0.3"' : ''}>
                                                Adicionar ao Carrinho
                                            </button>
                                        </div>
                                    </div>
                                `).join('')}
                            </div>
                        `;
                        container.appendChild(section);
                    }
                });
            });
        }

        function addToCart(id, name, price, image) {
            let cart = JSON.parse(localStorage.getItem("cart")) || [];
            const index = cart.findIndex(item => item.id === id);
            if (index > -1) cart[index].qty++;
            else cart.push({ id, name, price, image, qty: 1 });
            localStorage.setItem("cart", JSON.stringify(cart));
            alert("Joia adicionada!");
        }

        renderProducts();
    </script>
</body>
</html>
