<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>Painel Admin | Marcinha Semijoias</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
body{
  margin:0;
  font-family:Georgia, serif;
  background:#faf7f2;
  color:#333;
}
header{
  padding:20px 40px;
  border-bottom:1px solid #d6b48c;
  display:flex;
  justify-content:space-between;
  align-items:center;
}
nav a{
  margin-left:20px;
  cursor:pointer;
  font-size:12px;
  letter-spacing:2px;
  text-transform:uppercase;
  color:#b48b5a;
  border-bottom:2px solid transparent;
  padding-bottom:4px;
}
nav a.active{ border-color:#b48b5a; }
main{ padding:40px; max-width:1100px; margin:auto; }
h2{ border-bottom:1px solid #d6b48c; padding-bottom:10px; }

.tab{ display:none; }
.tab.active{ display:block; }

label{ display:block; margin-top:15px; font-size:14px; }
input,textarea{
  width:100%; padding:10px; margin-top:5px;
  border:1px solid #ccc; border-radius:4px;
}
button{
  margin-top:20px;
  padding:10px 25px;
  background:#b48b5a;
  color:#fff;
  border:none;
  border-radius:4px;
  cursor:pointer;
}

.produtos-grid{
  display:grid;
  grid-template-columns:repeat(auto-fill,minmax(200px,1fr));
  gap:20px;
  margin-top:30px;
}
.produto{
  background:#fff;
  border:1px solid #ddd;
  border-radius:6px;
  padding:10px;
  text-align:center;
}
.produto img{
  width:100%;
  height:180px;
  object-fit:cover;
  border-radius:4px;
}
.produto h4{ margin:10px 0 5px; font-weight:normal; }
.produto span{ font-size:14px; color:#777; }
.produto button{
  background:#c0392b;
  margin-top:10px;
}
</style>
</head>

<body>

<header>
  <h1>Marcinha Semijoias</h1>
  <nav>
    <a onclick="showTab('vendas')" class="active">Vendas</a>
    <a onclick="showTab('produtos')">Produtos</a>
    <a onclick="showTab('config')">Config</a>
  </nav>
</header>

<main>

<section id="vendas" class="tab active">
  <h2>Pedidos</h2>
  <p>Pedidos aparecerão aqui.</p>
</section>

<section id="produtos" class="tab">
  <h2>Cadastrar Produto</h2>

  <label>Nome do Produto
    <input id="pNome">
  </label>

  <label>Descrição
    <textarea id="pDesc"></textarea>
  </label>

  <label>Preço (R$)
    <input id="pPreco" type="number" step="0.01">
  </label>

  <label>Estoque
    <input id="pEstoque" type="number">
  </label>

  <label>Imagem do Produto
    <input id="pImagem" type="file" accept="image/*">
  </label>

  <button onclick="salvarProduto()">Salvar Produto</button>

  <h2 style="margin-top:50px">Produtos Cadastrados</h2>
  <div class="produtos-grid" id="listaProdutos"></div>
</section>

<section id="config" class="tab">
  <h2>Configurações</h2>
  <p>Configurações já implementadas.</p>
</section>

</main>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.4/firebase-app.js";
import { getFirestore, collection, addDoc, getDocs, deleteDoc, doc } from "https://www.gstatic.com/firebasejs/10.12.4/firebase-firestore.js";
import { getStorage, ref, uploadBytes, getDownloadURL } from "https://www.gstatic.com/firebasejs/10.12.4/firebase-storage.js";

const firebaseConfig = {
  apiKey: "SUA_API_KEY",
  authDomain: "SEU_DOMINIO.firebaseapp.com",
  projectId: "SEU_PROJECT_ID",
  storageBucket: "SEU_BUCKET.appspot.com",
  messagingSenderId: "SEU_SENDER_ID",
  appId: "SEU_APP_ID"
};

const app = initializeApp(firebaseConfig);
const db = getFirestore(app);
const storage = getStorage(app);

window.showTab = function(tab){
  document.querySelectorAll('.tab').forEach(t=>t.classList.remove('active'));
  document.querySelectorAll('nav a').forEach(a=>a.classList.remove('active'));
  document.getElementById(tab).classList.add('active');
  event.target.classList.add('active');
};

async function listarProdutos(){
  listaProdutos.innerHTML = "";
  const snap = await getDocs(collection(db,"produtos"));
  snap.forEach(docu=>{
    const p = docu.data();
    listaProdutos.innerHTML += `
      <div class="produto">
        <img src="${p.imagem}">
        <h4>${p.nome}</h4>
        <span>R$ ${p.preco.toFixed(2)}</span>
        <button onclick="excluirProduto('${docu.id}')">Excluir</button>
      </div>
    `;
  });
}

window.salvarProduto = async function(){
  const file = pImagem.files[0];
  if(!file) return alert("Selecione uma imagem");

  const imgRef = ref(storage, "produtos/"+Date.now()+"-"+file.name);
  await uploadBytes(imgRef,file);
  const imgURL = await getDownloadURL(imgRef);

  await addDoc(collection(db,"produtos"),{
    nome:pNome.value,
    descricao:pDesc.value,
    preco:Number(pPreco.value),
    estoque:Number(pEstoque.value),
    imagem:imgURL,
    criadoEm:new Date()
  });

  pNome.value=pDesc.value=pPreco.value=pEstoque.value="";
  pImagem.value="";
  listarProdutos();
};

window.excluirProduto = async function(id){
  if(confirm("Excluir produto?")){
    await deleteDoc(doc(db,"produtos",id));
    listarProdutos();
  }
};

listarProdutos();
</script>

</body>
</html>
