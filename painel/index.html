<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>Painel Admin</title>

<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-storage-compat.js"></script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>

<style>
body{font-family:Arial;background:#111;color:#fff}
input,button{padding:8px;margin:5px;width:100%}
section{max-width:600px;margin:30px auto}
.hidden{display:none}
.order{border:1px solid #444;padding:10px;margin:10px 0}
</style>
</head>
<body>

<section id="login">
<h2>Login Admin</h2>
<input id="email" placeholder="Email">
<input id="pass" type="password">
<button onclick="login()">Entrar</button>
</section>

<section id="painel" class="hidden">
<h2>Painel Administrativo</h2>

<h3>Pedidos</h3>
<div id="orders"></div>

<button onclick="logout()">Sair</button>
</section>

<!-- MODELO PDF (OCULTO) -->
<div id="pdf" style="display:none;padding:30px;font-family:Arial">
<h2>Marcinha Semijoias</h2>
<p id="pdfCliente"></p>
<p id="pdfStatus"></p>
<hr>
<div id="pdfItens"></div>
<hr>
<p><strong>Total:</strong> R$ <span id="pdfTotal"></span></p>
<p style="margin-top:40px">Assinatura: __________________________</p>
</div>

<script>
const firebaseConfig={
 apiKey:"SUA_API_KEY",
 authDomain:"SEU_AUTH",
 databaseURL:"SUA_DATABASE",
 projectId:"SEU_PROJECT",
 storageBucket:"SEU_BUCKET"
};
firebase.initializeApp(firebaseConfig);

const auth=firebase.auth();
const db=firebase.database();

auth.onAuthStateChanged(u=>{
 login.classList.toggle('hidden',!!u);
 painel.classList.toggle('hidden',!u);
 if(u) loadOrders();
});

function login(){
 auth.signInWithEmailAndPassword(email.value,pass.value)
 .catch(e=>alert(e.message));
}
function logout(){auth.signOut();}

function loadOrders(){
 db.ref('orders').on('value', s=>{
  orders.innerHTML='';
  s.forEach(o=>{
   const v=o.val();
   orders.innerHTML+=`
   <div class="order">
    <strong>${v.customer}</strong><br>
    Total: R$ ${v.total}<br>
    Status: ${v.status}<br>
    <button onclick="gerarPDF('${o.key}')">Gerar PDF</button>
   </div>`;
  });
 });
}

function gerarPDF(id){
 db.ref('orders/'+id).once('value', s=>{
  const o=s.val();
  pdfCliente.innerText="Cliente: "+o.customer;
  pdfStatus.innerText="Status: "+o.status;
  pdfTotal.innerText=o.total;
  pdfItens.innerHTML='';
  o.items.forEach(i=>{
   pdfItens.innerHTML+=`<p>${i.name} - R$ ${i.price}</p>`;
  });

  html2pdf().set({
   margin:10,
   filename:`pedido-${id}.pdf`,
   html2canvas:{scale:2},
   jsPDF:{unit:'mm',format:'a4'}
  }).from(document.getElementById('pdf')).save();
 });
}
</script>
</body>
</html>
