<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Painel Admin | Marcinha Semijoias</title>

<script src="https://cdn.tailwindcss.com"></script>
<script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-database-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-storage-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-auth-compat.js"></script>

<style>
@import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600&family=Cinzel:wght@400;700&display=swap');
body{font-family:'Inter',sans-serif;background:#F8F6F2}
.font-serif{font-family:'Cinzel',serif}
.tab{display:none}
.tab.active{display:block}
.text-gold{color:#A68966}
.border-gold{border-color:#A68966}
</style>
</head>

<body>

<div id="app" class="hidden">

<header class="bg-white border-b py-6 px-8 flex justify-between sticky top-0 z-50">
  <div>
    <h1 class="font-serif text-xl tracking-[0.2em] text-gold">Marcinha Semijoias</h1>
    <p class="text-[9px] uppercase tracking-widest text-gray-400">Painel Administrativo</p>
  </div>
  <nav class="flex gap-6 text-[10px] uppercase font-bold tracking-widest">
    <span onclick="openTab('vendas')" class="cursor-pointer text-gold">Vendas</span>
    <span onclick="openTab('produtos')" class="cursor-pointer">Produtos</span>
    <span onclick="openTab('config')" class="cursor-pointer">Config</span>
    <span onclick="logout()" class="cursor-pointer text-red-400">Sair</span>
  </nav>
</header>

<main class="max-w-5xl mx-auto p-8">

<!-- VENDAS -->
<div id="vendas" class="tab active">
  <h2 class="font-serif text-2xl mb-6 border-b border-gold pb-2">Pedidos</h2>
  <div id="ordersList" class="grid gap-4"></div>
</div>

<!-- PRODUTOS -->
<div id="produtos" class="tab">
  <h2 class="font-serif text-2xl mb-6 border-b border-gold pb-2">Cadastrar Joia</h2>

  <div class="bg-white p-6 border grid md:grid-cols-2 gap-6">
    <div class="space-y-4">
      <input id="p-name" placeholder="Nome da peça" class="w-full border p-3 text-sm">
      <input id="p-price" type="number" placeholder="Preço" class="w-full border p-3 text-sm">
      <input id="p-stock" type="number" placeholder="Estoque" class="w-full border p-3 text-sm">
    </div>
    <div class="space-y-4">
      <input id="p-image" type="file" accept="image/*" class="w-full border p-3 text-sm">
      <input id="p-sku" placeholder="SKU" class="w-full border p-3 text-sm">
      <select id="p-category" class="w-full border p-3 text-sm">
        <option>Brincos</option><option>Colares</option><option>Pulseiras</option><option>Aneis</option>
      </select>
    </div>
  </div>

  <button onclick="saveProduct()" class="mt-6 bg-black text-white px-8 py-3 text-[10px] uppercase tracking-widest">
    Salvar Produto
  </button>
</div>

<!-- CONFIG -->
<div id="config" class="tab">
  <h2 class="font-serif text-2xl mb-6 border-b border-gold pb-2">Configurações</h2>
  <div class="bg-white p-6 border max-w-xs space-y-4">
    <input id="conf-pix" type="number" placeholder="% Desconto PIX" class="w-full border p-3 text-sm">
    <input id="conf-parcelas" type="number" placeholder="Parcelas" class="w-full border p-3 text-sm">
    <button onclick="saveConfig()" class="w-full bg-[#A68966] text-white py-3 text-[10px] uppercase">
      Salvar
    </button>
  </div>
</div>

</main>
</div>

<!-- LOGIN -->
<div id="login" class="h-screen flex items-center justify-center bg-[#F8F6F2]">
  <div class="bg-white p-8 border w-full max-w-sm">
    <h2 class="font-serif text-xl text-center mb-6">Acesso Restrito</h2>
    <input id="email" placeholder="Email" class="border p-2 w-full mb-3">
    <input id="password" type="password" placeholder="Senha" class="border p-2 w-full mb-4">
    <button onclick="login()" class="w-full bg-black text-white py-2 uppercase text-xs">Entrar</button>
  </div>
</div>

<script>
const firebaseConfig={
 apiKey:"AIzaSyD5RdWTYOnaTov7VtM9ZGenUpFYSZVGoPs",
 authDomain:"marcinha-semijoias.firebaseapp.com",
 databaseURL:"https://marcinha-semijoias-default-rtdb.firebaseio.com",
 projectId:"marcinha-semijoias",
 storageBucket:"marcinha-semijoias.appspot.com",
 messagingSenderId:"830107812924",
 appId:"1:830107812924:web:1ee54d9b875514e48eef39"
};

if(!firebase.apps.length) firebase.initializeApp(firebaseConfig);

const db=firebase.database();
const auth=firebase.auth();
const storage=firebase.storage();

auth.onAuthStateChanged(user=>{
  if(user){
    login.style.display='none';
    app.classList.remove('hidden');
  }
});

function login(){
 auth.signInWithEmailAndPassword(email.value,password.value)
 .catch(e=>alert(e.message));
}
function logout(){auth.signOut()}

function openTab(id){
 document.querySelectorAll('.tab').forEach(t=>t.classList.remove('active'));
 document.getElementById(id).classList.add('active');
}

function saveProduct(){
 const file=p-image.files[0];
 if(!file) return alert("Selecione imagem");

 const ref=storage.ref('products/'+Date.now()+"_"+file.name);
 ref.put(file).then(snap=>{
  snap.ref.getDownloadURL().then(url=>{
    db.ref('products').push({
      name:p-name.value,
      price:+p-price.value,
      stock:+p-stock.value,
      sku:p-sku.value,
      category:p-category.value,
      image:url
    }).then(()=>location.reload());
  });
 });
}

db.ref('orders').on('value',s=>{
 ordersList.innerHTML='';
 if(!s.val()) return ordersList.innerHTML='<p>Sem pedidos</p>';
 Object.values(s.val()).reverse().forEach(o=>{
  ordersList.innerHTML+=`
   <div class="bg-white border p-4">
    <strong>${o.customer}</strong>
    <p>${o.items}</p>
    <span>R$ ${o.total}</span>
   </div>`;
 });
});

function saveConfig(){
 db.ref('settings').set({
  pix:+conf-pix.value,
  parcelas:+conf-parcelas.value
 });
}
</script>

</body>
</html>
